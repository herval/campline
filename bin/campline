#!/usr/bin/env ruby

require "campline"

if ARGV.size != 3
  puts "Usage: campline <domain> <room> <username>"
  exit 1
end

begin
  domain, room, username = *ARGV

  begin
    %x{stty -echo}
    puts "Type in your password:"
    password = $stdin.gets.strip
  ensure
    %x{stty raw -echo}
  end

  Campline::Client.new(domain, room, username, password).listen!
ensure
  %x{stty -raw echo}
end