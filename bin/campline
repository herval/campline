#!/usr/bin/ruby

require "campline"

if ARGV.size != 3
  puts "Usage: campline <domain> <room> <username>"
  exit 1
end

begin
  domain, room, username = *ARGV

  begin
    %x{stty -icanon -echo}
    puts "Type in your password:"
    password = "fulano" #$stdin.gets.strip
  ensure
    %x{stty icanon echo}
  end

  Campline::Client.new(domain, room, username, password).listen!
end